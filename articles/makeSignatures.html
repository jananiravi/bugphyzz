<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Make Signatures • bugphyzz</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Make Signatures">
<meta property="og:description" content="bugphyzz">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bugphyzz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/checks.html">Check Functions</a>
    </li>
    <li>
      <a href="../articles/complete_summary_stats.html">Complete BugPhyzz Stats</a>
    </li>
    <li>
      <a href="../articles/completeness_annotations.html">Completeness of annotations based on NCBI IDs</a>
    </li>
    <li>
      <a href="../articles/makeSignatures.html">Make Signatures</a>
    </li>
    <li>
      <a href="../articles/summary_statistics.html">BugPhyzz Stats</a>
    </li>
    <li>
      <a href="../articles/write_physiology_sets.html">write_physiology_sets</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="makeSignatures_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Make Signatures</h1>
            
      
      
      <div class="hidden name"><code>makeSignatures.Rmd</code></div>

    </div>

    
    
<p>The <code>bugphyzz</code> package provides functionality to help in the creation of microbial signatures that can be used as inputs for other R packages, such as <code>EnrichmentBrowser</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">bugphyzz</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span></code></pre></div>
<p>The first step for the creation of microbial signatures is to import a dataset with the <code>physiologies</code> or the <code>fattyAcidCompositon</code> functions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/physiologies.html">physiologies</a></span><span class="op">(</span><span class="st">"aerophilicity"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Finished aerophilicity</span></code></pre></div>
<p>A list of signatures can be easily created with the <code>makeSignatures</code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Signatures with NCBI IDs</span>
<span class="va">aer_sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeSignatures.html">makeSignatures</a></span><span class="op">(</span><span class="va">aer</span>, taxids <span class="op">=</span> <span class="st">"NCBI_ID"</span>, min_sig_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">aer_sig</span>, <span class="va">head</span><span class="op">)</span>
<span class="co">#&gt; $aerobic</span>
<span class="co">#&gt; [1] "10" "16" "20" "59" "68" "71"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $anaerobic</span>
<span class="co">#&gt; [1] "18"  "96"  "157" "279" "657" "816"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`facultatively anaerobic`</span>
<span class="co">#&gt; [1] "22"  "146" "538" "541" "544" "547"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $microaerophilic</span>
<span class="co">#&gt; [1] "6"     "191"   "963"   "12960" "13134" "40544"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`obligately aerobic`</span>
<span class="co">#&gt; [1] "99"  "123" "179" "222" "237" "338"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`obligately anaerobic`</span>
<span class="co">#&gt; [1] "146" "832" "836" "848" "864" "866"</span></code></pre></div>
<p>Above, the <code>taxids = "NCBI_ID</code> option was used to create signatures with NCBI taxonomy IDs. Other available options are <code>Accession_number</code>, <code>Genome_ID</code>, and <code>Taxon_name</code>.</p>
<p>Signatures with accession number:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Signatures with accession numbers</span>
<span class="va">aer_sig_acc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeSignatures.html">makeSignatures</a></span><span class="op">(</span><span class="va">aer</span>, taxids <span class="op">=</span> <span class="st">"Accession_number"</span>, min_sig_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">aer_sig_acc</span>, <span class="va">head</span><span class="op">)</span>
<span class="co">#&gt; $aerobic</span>
<span class="co">#&gt; [1] "NC_009925, NC_009926, NC_009927, NC_009928, NC_009929, NC_009930, NC_009931, NC_009932, NC_009933, NC_009934"</span>
<span class="co">#&gt; [2] "NC_013209, NC_013210, NC_013211, NC_013212, NC_013213, NC_013214, NC_013215"                                 </span>
<span class="co">#&gt; [3] "NC_014640, NC_014641, NC_014642"                                                                             </span>
<span class="co">#&gt; [4] "NC_009467, NC_009468, NC_009469, NC_009470, NC_009471, NC_009472, NC_009473, NC_009474, NC_009484"           </span>
<span class="co">#&gt; [5] "NC_015178, NC_015179, NC_015180, NC_015181, NC_015182, NC_015186, NC_015187, NC_015188, NC_015189"           </span>
<span class="co">#&gt; [6] "NC_011206"                                                                                                   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $anaerobic</span>
<span class="co">#&gt; [1] "NC_014378" "NC_013740" "NC_014374" "NC_013124" "NC_013926" "NC_015278"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`facultatively anaerobic`</span>
<span class="co">#&gt; [1] "NC_010163" "NC_015518" "NC_011761" "NC_011992" "NC_010278" "NC_009053"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $microaerophilic</span>
<span class="co">#&gt; [1] "NC_014166"                                                                                                                                                                                                                                       </span>
<span class="co">#&gt; [2] "NC_008702"                                                                                                                                                                                                                                       </span>
<span class="co">#&gt; [3] "NC_014171, NC_014172"                                                                                                                                                                                                                            </span>
<span class="co">#&gt; [4] "NC_015903, NC_015904, NC_015905, NC_015906, NC_015907, NC_015908, NC_015909, NC_015910, NC_015911, NC_015915, NC_015916, NC_015917, NC_015918, NC_015919, NC_015920, NC_015921, NC_015922"                                                       </span>
<span class="co">#&gt; [5] "NC_000948, NC_000949, NC_000950, NC_000951, NC_000952, NC_000953, NC_000954, NC_000955, NC_000956, NC_000957, NC_001318, NC_001849, NC_001850, NC_001851, NC_001852, NC_001853, NC_001854, NC_001855, NC_001856, NC_001857, NC_001903, NC_001904"</span>
<span class="co">#&gt; [6] "NC_011720, NC_011722, NC_011724, NC_011728, NC_011731, NC_011735, NC_011736, NC_011778, NC_011779, NC_011780, NC_011781, NC_011782, NC_011783, NC_011784, NC_011785"                                                                             </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`obligately aerobic`</span>
<span class="co">#&gt; [1] "NC_014750, NC_014759"                      </span>
<span class="co">#&gt; [2] "NC_015579, NC_015580, NC_015582, NC_015583"</span>
<span class="co">#&gt; [3] "NC_013523, NC_013524"                      </span>
<span class="co">#&gt; [4] "NC_014221"                                 </span>
<span class="co">#&gt; [5] "NC_014158, NC_014159"                      </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`obligately anaerobic`</span>
<span class="co">#&gt; [1] "NC_014497"                                                       </span>
<span class="co">#&gt; [2] "NC_015686, NC_015687, NC_015688"                                 </span>
<span class="co">#&gt; [3] "NC_015417, NC_015418, NC_015419, NC_015425, NC_015426, NC_015427"</span>
<span class="co">#&gt; [4] "NC_013315"                                                       </span>
<span class="co">#&gt; [5] "NC_015565"                                                       </span>
<span class="co">#&gt; [6] "NC_015573"</span></code></pre></div>
<p>Signatures with taxon names</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Signatures with taxa names</span>
<span class="va">aer_sig_taxnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeSignatures.html">makeSignatures</a></span><span class="op">(</span><span class="va">aer</span>, taxids <span class="op">=</span> <span class="st">"Taxon_name"</span>, min_sig_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">aer_sig_taxnames</span>, <span class="va">head</span><span class="op">)</span>
<span class="co">#&gt; $aerobic</span>
<span class="co">#&gt; [1] "Cellvibrio"       "Methylophilus"    "Phenylobacterium" "Vitreoscilla "   </span>
<span class="co">#&gt; [5] "Lysobacter"       "Simonsiella"     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $anaerobic</span>
<span class="co">#&gt; [1] "Pelobacter"     "Gallionella"    "Treponema"      "Xanthobacter"  </span>
<span class="co">#&gt; [5] "Photobacterium" "Bacteroides"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`facultatively anaerobic`</span>
<span class="co">#&gt; [1] "Shewanella "  "Spirochaeta " "Eikenella "   "Zymomonas "   "Citrobacter" </span>
<span class="co">#&gt; [6] "Enterobacter"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $microaerophilic</span>
<span class="co">#&gt; [1] "Azorhizobium"     "Azospirillum"     "Herbaspirillum"   "Azoarcus "       </span>
<span class="co">#&gt; [5] "Magnetospirillum" "Sutterella "     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`obligately aerobic`</span>
<span class="co">#&gt; [1] "Ancylobacter"    "Pirellula"       "Leptospirillum"  "Achromobacter " </span>
<span class="co">#&gt; [5] "Flavobacterium " "Xanthomonas"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`obligately anaerobic`</span>
<span class="co">#&gt; [1] "Spirochaeta "  "Fibrobacter"   "Porphyromonas" "Fusobacterium"</span>
<span class="co">#&gt; [5] "Pectinatus"    "Ruminobacter"</span></code></pre></div>
<p>If there are no taxa with some type of ID, no signatures would be created:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## This dataset does not contain Genome ID annotaions</span>
<span class="fu"><a href="../reference/makeSignatures.html">makeSignatures</a></span><span class="op">(</span><span class="va">aer</span>, taxids <span class="op">=</span> <span class="st">"Genome_ID"</span>, min_sig_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; No signatures.</span>
<span class="co">#&gt; NULL</span></code></pre></div>
<div id="ranked-signatures" class="section level2">
<h2 class="hasAnchor">
<a href="#ranked-signatures" class="anchor"></a>Ranked signatures</h2>
<p>The signatures above contained taxa of mixed rank levels, e.g., genus and strain. Signatures at a specific taxonomy rank can be created with the <code>tax_rank = &lt;rank&gt;</code> and <code>sig_type = "ranked"</code> options:</p>
<p>Signatures at the genus level:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Signatures at the genus level</span>
<span class="va">aer_sig_genus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeSignatures.html">makeSignatures</a></span><span class="op">(</span><span class="va">aer</span>, taxids <span class="op">=</span> <span class="st">"Taxon_name"</span>, tax_rank <span class="op">=</span> <span class="st">"genus"</span>, sig_type <span class="op">=</span> <span class="st">"ranked"</span>, min_sig_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">aer_sig_genus</span>, <span class="va">head</span><span class="op">)</span>
<span class="co">#&gt; $aerobic</span>
<span class="co">#&gt; [1] "Cellvibrio"       "Methylophilus"    "Phenylobacterium" "Vitreoscilla "   </span>
<span class="co">#&gt; [5] "Lysobacter"       "Simonsiella"     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $anaerobic</span>
<span class="co">#&gt; [1] "Pelobacter"     "Gallionella"    "Treponema"      "Xanthobacter"  </span>
<span class="co">#&gt; [5] "Photobacterium" "Bacteroides"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`facultatively anaerobic`</span>
<span class="co">#&gt; [1] "Shewanella "  "Spirochaeta " "Eikenella "   "Zymomonas "   "Citrobacter" </span>
<span class="co">#&gt; [6] "Enterobacter"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $microaerophilic</span>
<span class="co">#&gt; [1] "Azorhizobium"     "Azospirillum"     "Herbaspirillum"   "Azoarcus "       </span>
<span class="co">#&gt; [5] "Magnetospirillum" "Sutterella "     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`obligately aerobic`</span>
<span class="co">#&gt; [1] "Ancylobacter"    "Pirellula"       "Leptospirillum"  "Achromobacter " </span>
<span class="co">#&gt; [5] "Flavobacterium " "Xanthomonas"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`obligately anaerobic`</span>
<span class="co">#&gt; [1] "Spirochaeta "  "Fibrobacter"   "Porphyromonas" "Fusobacterium"</span>
<span class="co">#&gt; [5] "Pectinatus"    "Ruminobacter"</span></code></pre></div>
<p>Signatures at the strain level:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Signatures at the strain level</span>
<span class="va">aer_sig_strain</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeSignatures.html">makeSignatures</a></span><span class="op">(</span><span class="va">aer</span>, taxids <span class="op">=</span> <span class="st">"Taxon_name"</span>, tax_rank <span class="op">=</span> <span class="st">"strain"</span>, sig_type <span class="op">=</span> <span class="st">"ranked"</span>, min_sig_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">aer_sig_strain</span>, <span class="va">head</span><span class="op">)</span>
<span class="co">#&gt; $aerobic</span>
<span class="co">#&gt; [1] "Acaryochloris marina MBIC11017"           </span>
<span class="co">#&gt; [2] "Achromobacter xylosoxidans A8"            </span>
<span class="co">#&gt; [3] "Acidiphilium cryptum JF-5"                </span>
<span class="co">#&gt; [4] "Acidiphilium multivorum AIU301"           </span>
<span class="co">#&gt; [5] "Acidithiobacillus ferrooxidans ATCC 53993"</span>
<span class="co">#&gt; [6] "Acidobacterium capsulatum ATCC 51196"     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $anaerobic</span>
<span class="co">#&gt; [1] "Acetohalobium arabaticum DSM 5501"    </span>
<span class="co">#&gt; [2] "Acidaminococcus fermentans DSM 20731" </span>
<span class="co">#&gt; [3] "Acidilobus saccharovorans 345-15"     </span>
<span class="co">#&gt; [4] "Acidimicrobium ferrooxidans DSM 10331"</span>
<span class="co">#&gt; [5] "Aciduliprofundum boonei T469"         </span>
<span class="co">#&gt; [6] "Aerococcus urinae ACS-120-V-Col10a"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`facultatively anaerobic`</span>
<span class="co">#&gt; [1] "Acholeplasma laidlawii PG-8A"                       </span>
<span class="co">#&gt; [2] "Acidianus hospitalis W1"                            </span>
<span class="co">#&gt; [3] "Acidithiobacillus ferrooxidans ATCC 23270"          </span>
<span class="co">#&gt; [4] "Acidovorax ebreus TPSY"                             </span>
<span class="co">#&gt; [5] "Actinobacillus pleuropneumoniae serovar 3 str. JL03"</span>
<span class="co">#&gt; [6] "Actinobacillus pleuropneumoniae serovar 5b str. L20"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $microaerophilic</span>
<span class="co">#&gt; [1] "Arcobacter nitrofigilis DSM 7299" "Bacillus thuringiensis BMB171"   </span>
<span class="co">#&gt; [3] "Borrelia bissettii DN127"         "Borrelia burgdorferi B31"        </span>
<span class="co">#&gt; [5] "Borrelia burgdorferi ZS7"         "Caldivirga maquilingensis IC-167"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`obligately anaerobic`</span>
<span class="co">#&gt; [1] "Candidatus Zinderia insecticola CARI"     </span>
<span class="co">#&gt; [2] "Clostridium acetobutylicum DSM 1731"      </span>
<span class="co">#&gt; [3] "Clostridium botulinum BKT015925"          </span>
<span class="co">#&gt; [4] "Clostridium difficile CD196"              </span>
<span class="co">#&gt; [5] "Desulfotomaculum carboxydivorans CO-1-SRB"</span>
<span class="co">#&gt; [6] "Desulfotomaculum kuznetsovii DSM 6115"</span></code></pre></div>
<p>Currently, ranked signtures are limited at the “genus”, “species”, and “strain” levels:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="../reference/makeSignatures.html">makeSignatures</a></span><span class="op">(</span><span class="va">aer</span>, taxids <span class="op">=</span> <span class="st">"Taxon_name"</span>, tax_rank <span class="op">=</span> <span class="st">"class"</span>, sig_type <span class="op">=</span> <span class="st">"ranked"</span>, min_sig_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,
         error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">cnd</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/conditions.html">conditionMessage</a></span><span class="op">(</span><span class="va">cnd</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "Invalid taxonomy rank with 'sig_type = \"ranked\"' option. Select one of: genus, species, or strain"</span></code></pre></div>
</div>
<div id="inherited-signatures" class="section level2">
<h2 class="hasAnchor">
<a href="#inherited-signatures" class="anchor"></a>Inherited signatures</h2>
<p>Since annotations in the datasets in bugphyzz can come from diverse sources, some taxa might be annotated at a given taxonomic rank, e.g., species, but not at a higher level, e.g., genus. Some users might be interested in creating signatures at those higher levels. In this case, the <code>sig_type = "inherited"</code> option can be used to create an “inherited” signature.</p>
<p>As an example, let’s create a signature at the genus level of extreme thermophilic microbes growing at 80°C or above.</p>
<p>First, let’s import the “growth temperature” datasets and filter those microbes growing at 80°C or above:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/physiologies.html">physiologies</a></span><span class="op">(</span><span class="st">"growth temperature"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt; Finished growth temperature</span>
<span class="va">tm</span> <span class="op">&lt;-</span> <span class="va">gt</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Attribute_value</span> <span class="op">&gt;</span> <span class="fl">80</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">tm</span><span class="op">$</span><span class="va">Attribute_value</span>, main <span class="op">=</span> <span class="cn">NULL</span>, xlab <span class="op">=</span> <span class="st">"Growth temperature (°C)"</span><span class="op">)</span></code></pre></div>
<p><img src="makeSignatures_files/figure-html/unnamed-chunk-10-1.png" width="480"></p>
<p>If we attempt to create a signature at the genus level of these extreme thermophiles, we would not get an output because the dataset does not contain annotations at the genus level:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tm_sig_genus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeSignatures.html">makeSignatures</a></span><span class="op">(</span><span class="va">tm</span>, taxids <span class="op">=</span> <span class="st">"Taxon_name"</span>, sig_type <span class="op">=</span> <span class="st">"ranked"</span>, tax_rank <span class="op">=</span> <span class="st">"genus"</span><span class="op">)</span>
<span class="co">#&gt; No signatures.</span>
<span class="va">tm_sig_genus</span>
<span class="co">#&gt; NULL</span></code></pre></div>
<p>However, the dataset does contain annotations at the species and strain levels:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## signature at the species level</span>
<span class="fu"><a href="../reference/makeSignatures.html">makeSignatures</a></span><span class="op">(</span><span class="va">tm</span>, taxids <span class="op">=</span> <span class="st">"Taxon_name"</span>, sig_type <span class="op">=</span> <span class="st">"ranked"</span>, tax_rank <span class="op">=</span> <span class="st">"species"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] "Methanocaldococcus sp. FS406-22"    "Aquifex pyrophilus Ko15a; DSM 6858"</span>
<span class="co">#&gt; [3] "Anoxybacillus flavithermus"         "Aquifex aeolicus"                  </span>
<span class="co">#&gt; [5] "Burkholderia gladioli"              "Candidatus Korarchaeum cryptofilum"</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## signature at the strain level</span>
<span class="fu"><a href="../reference/makeSignatures.html">makeSignatures</a></span><span class="op">(</span><span class="va">tm</span>, taxids <span class="op">=</span> <span class="st">"Taxon_name"</span>, sig_type <span class="op">=</span> <span class="st">"ranked"</span>, tax_rank <span class="op">=</span> <span class="st">"strain"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] "Aeropyrum pernix K1"                 "Aquifex aeolicus VF5"               </span>
<span class="co">#&gt; [3] "Archaeoglobus fulgidus DSM 4304"     "Caldivirga maquilingensis IC-167"   </span>
<span class="co">#&gt; [5] "Desulfurococcus kamchatkensis 1221n" "Ferroglobus placidus DSM 10642"</span></code></pre></div>
<p>So, we can create a signature of genera that inherit their annotations from these lower taxonomic ranks (species and strain) with the <code>sig_type = "inherited"</code> option:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tm_sig_genus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeSignatures.html">makeSignatures</a></span><span class="op">(</span><span class="va">tm</span>, taxids <span class="op">=</span> <span class="st">"Taxon_name"</span>, sig_type <span class="op">=</span> <span class="st">"inherited"</span>, tax_rank <span class="op">=</span> <span class="st">"genus"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tm_sig_genus</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] "Aeropyrum"       "Aquifex"         "Archaeoglobus"   "Caldivirga"     </span>
<span class="co">#&gt; [5] "Desulfurococcus" "Ferroglobus"</span></code></pre></div>
<p>We recommend caution when using and interpreting the inherited signatures. For example, the output of the code below indicates that the growth temperature dataset contains one or more taxa that belong to the superkingdoms Archaea and Bacteria, not that all taxa in Archaea and Bacteria are thermophiles:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/makeSignatures.html">makeSignatures</a></span><span class="op">(</span><span class="va">tm</span>, taxids <span class="op">=</span> <span class="st">"Taxon_name"</span>, sig_type <span class="op">=</span> <span class="st">"inherited"</span>, tax_rank <span class="op">=</span> <span class="st">"superkingdom"</span><span class="op">)</span>
<span class="co">#&gt; $`growth temperature`</span>
<span class="co">#&gt; [1] "Archaea"  "Bacteria"</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
